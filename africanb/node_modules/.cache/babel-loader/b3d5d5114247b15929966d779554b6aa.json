{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { required, minLength } from 'vuelidate/lib/validators';\nimport { API_OBTENIR_REFERENCE_PAR_PAR_FAMILLE, API_OBTENIR_LISTE_DES_VILLES_DISPONIBLE } from '../globalConfig/globalConstConfig';\nimport { API_RECUPERER_PRIX_PAR_OFFRE_VOYAGE, API_RECUPERER_VILLE_ESCALE_PAR_OFFRE_VOYAGE } from '../globalConfig/globalConstConfig';\nimport { API_OBENIR_JOUR_SEMAINE_PAR_OFFRE_VOYAGE, API_RECUPERER_PROPRIETE_PAR_OFFRE_VOYAGE } from '../globalConfig/globalConstConfig';\nimport axios from 'axios';\nimport $ from 'jquery';\nexport default {\n  name: 'ModifierOffreVoyage',\n  data() {\n    return {\n      search: '',\n      headers: [{\n        text: 'Designation',\n        value: 'designation'\n      }, {\n        text: 'Pays',\n        value: 'paysDesignation'\n      }, {\n        text: 'Actions',\n        value: 'actions',\n        sortable: false\n      }],\n      errorMsg: null,\n      successMsg: null,\n      overlay: false,\n      loadingModePrix: false,\n      loadingVilleEscale: false,\n      loadingProgrammeOffreVoyage: false,\n      loadingProprieteOffreVoyage: false,\n      simpleObject: {},\n      offreVoyageObject: {\n        data: {\n          designation: null\n        }\n      },\n      offreVoyage: {\n        id: null,\n        designation: null,\n        description: null,\n        compagnieTransportRaisonSociale: \"COMPAGNIE KOUEVI CT\",\n        typeOffreVoyageDesignation: null,\n        villeDepartDesignation: null,\n        villeDestinationDesignation: null\n      },\n      referenceTypeOffreVoyageList: [],\n      villesList: [],\n      referenceTypeOffreVoyage: {\n        referenceFamilleDesignation: \"referenceFamilleTypeOffreVoyage\"\n      },\n      objectToSend: {\n        datas: []\n      },\n      prixEtModeParOffreVoyageList: [],\n      villesEscalesParOffreVoyagesList: [],\n      jourSemainesParOffreVoyagesList: [],\n      proprieteParOffreVoyageList: []\n    };\n  },\n  validations: {\n    offreVoyage: {\n      designation: {\n        required,\n        minLength: minLength(4)\n      },\n      description: {\n        required,\n        minLength: minLength(4)\n      },\n      villeDepartDesignation: {\n        required\n      },\n      villeDestinationDesignation: {\n        required\n      },\n      typeOffreVoyageDesignation: {\n        required\n      }\n    }\n  },\n  methods: {\n    //RENDRE VISIBLE LES INFORMATIONS SUR L'OFFRE DE VOYAGE SÉLECTIONNÉ\n    isVisibleOffreVoyageInfo() {\n      $(\"#card-info-offre-voyage\").slideToggle(500);\n    },\n    //VISIBILITE DU MODE ET DU PRIX\n    async isVisiblePrixModeOffreVoyage() {\n      $(\"#card-prix-mode-offre-voyage\").slideToggle(500);\n      this.obtenirPrixEtModeParOffreVoyage();\n    },\n    //VISIBILITE DES VILLES ESCALES\n    async isVisibleVilleEscaleOffreVoyage() {\n      $(\"#card-ville-escale-offre-voyage\").slideToggle(500);\n      this.obtenirVilleEscaleParOffreVoyage();\n    },\n    async isVisibleProgrammeOffreVoyage() {\n      $(\"#card-programme-offre-voyage\").slideToggle(500);\n      this.obtenirJourSemaineParOffreVoyage();\n    },\n    async isVisibleProprieteOffreVoyage() {\n      $(\"#card-propriete-offre-voyage\").slideToggle(500);\n      this.obtenirProprietesOffreVoyage();\n    },\n    //OBTENIR LE PRIX ET LE MODE PAR OFFRE DE VOYAGE\n    async obtenirPrixEtModeParOffreVoyage() {\n      this.loadingModePrix = true;\n      this.offreVoyageObject.data.designation = this.offreVoyage.designation;\n      await axios.post(API_RECUPERER_PRIX_PAR_OFFRE_VOYAGE, this.offreVoyageObject).then(response => {\n        if (response.data.status.code == 800) {\n          this.prixEtModeParOffreVoyageList = response.data.items;\n        } else {\n          this.prixEtModeParOffreVoyageList = [];\n        }\n      }).catch(e => {\n        this.errorMsg = e;\n        $(\".alert-error\").fadeIn();\n        setTimeout(function () {\n          $(\".alert-error\").fadeOut();\n        }, 4000);\n      }).finally(() => {\n        this.loadingModePrix = false;\n      });\n    },\n    //OBTENIR LE JOUR DE LA SEMAINE DE L'OFFRE\n    async obtenirJourSemaineParOffreVoyage() {\n      this.loadingProgrammeOffreVoyage = true;\n      this.offreVoyageObject.data.designation = this.offreVoyage.designation;\n      await axios.post(API_OBENIR_JOUR_SEMAINE_PAR_OFFRE_VOYAGE, this.offreVoyageObject).then(response => {\n        if (response.data.status.code == 800) {\n          this.jourSemainesParOffreVoyagesList = response.data.items;\n        } else {\n          this.jourSemainesParOffreVoyagesList = [];\n        }\n      }).catch(e => {\n        this.errorMsg = e;\n        $(\".alert-error\").fadeIn();\n        setTimeout(function () {\n          $(\".alert-error\").fadeOut();\n        }, 4000);\n      }).finally(() => {\n        this.loadingProgrammeOffreVoyage = false;\n      });\n    },\n    // OBTENIR LA LISTE DES VILLES ESCALES PAR OFFRE DE VOYAGE\n    async obtenirVilleEscaleParOffreVoyage() {\n      this.loadingVilleEscale = true;\n      this.offreVoyageObject.data.designation = this.offreVoyage.designation;\n      await axios.post(API_RECUPERER_VILLE_ESCALE_PAR_OFFRE_VOYAGE, this.offreVoyageObject).then(response => {\n        if (response.data.status.code == 800) {\n          this.villesEscalesParOffreVoyagesList = response.data.items;\n        } else {\n          this.villesEscalesParOffreVoyagesList = [];\n        }\n      }).catch(e => {\n        this.errorMsg = e;\n        $(\".alert-error\").fadeIn();\n        setTimeout(function () {\n          $(\".alert-error\").fadeOut();\n        }, 4000);\n      }).finally(() => {\n        this.loadingVilleEscale = false;\n      });\n    },\n    // OBTENIR LA LISTE DES PROPRIETES (CARACTERISTIQUES) PAR OFFRE DE VOYAGES\n    async obtenirProprietesOffreVoyage() {\n      this.loadingProprieteOffreVoyage = true;\n      this.offreVoyageObject.data.designation = this.offreVoyage.designation;\n      await axios.post(API_RECUPERER_PROPRIETE_PAR_OFFRE_VOYAGE, this.offreVoyageObject).then(response => {\n        if (response.data.status.code == 800) {\n          this.proprieteParOffreVoyageList = response.data.items;\n        } else {\n          this.proprieteParOffreVoyageList = [];\n        }\n      }).catch(e => {\n        this.errorMsg = e;\n        $(\".alert-error\").fadeIn();\n        setTimeout(function () {\n          $(\".alert-error\").fadeOut();\n        }, 4000);\n      }).finally(() => {\n        this.loadingProprieteOffreVoyage = false;\n      });\n    },\n    //OBTENIR REFERENCE DESIGNATION TYPE OFFRE DE VOYAGE\n    async obtenirTypeOffreVoyageList() {\n      this.objectToSend.datas.push(this.referenceTypeOffreVoyage);\n      await axios.post(API_OBTENIR_REFERENCE_PAR_PAR_FAMILLE, this.objectToSend).then(response => {\n        this.referenceTypeOffreVoyageList = response.data.items;\n      }).catch(e => {\n        this.errorMsg = e;\n        $(\".alert-error\").fadeIn();\n        setTimeout(function () {\n          $(\".alert-error\").fadeOut();\n        }, 4000);\n      });\n    },\n    async editerOffreVoyage() {\n      if (localStorage.getItem(\"offreVoyage\")) {\n        try {\n          const offreVoyageEditing = JSON.parse(localStorage.getItem(\"offreVoyage\"));\n          this.offreVoyage.id = offreVoyageEditing.id;\n          this.offreVoyage.designation = offreVoyageEditing.designation;\n          this.offreVoyage.description = offreVoyageEditing.description;\n          this.offreVoyage.typeOffreVoyageDesignation = offreVoyageEditing.typeOffreVoyageDesignation;\n          this.offreVoyage.villeDepartDesignation = offreVoyageEditing.villeDepartDesignation;\n          this.offreVoyage.villeDestinationDesignation = offreVoyageEditing.villeDestinationDesignation;\n          localStorage.removeItem(\"offreVoyage\");\n        } catch (error) {\n          localStorage.removeItem(\"offreVoyage\");\n        }\n      } else {\n        this.$router.replace({\n          path: '/selectionnerOffreVoyage'\n        });\n      }\n    },\n    async obtenirListeDesVillesDisponible() {\n      this.loading = false;\n      await axios.post(API_OBTENIR_LISTE_DES_VILLES_DISPONIBLE, this.simpleObject).then(response => {\n        this.villesList = response.data.items;\n      }).catch(e => {\n        this.errorMsg = e;\n        $(\".alert-error\").fadeIn();\n        setTimeout(function () {\n          $(\".alert-error\").fadeOut();\n        }, 4000);\n      });\n    }\n  },\n  computed: {\n    // GESTION DES CONTRAINTES DE CHAMPS D'ENTREES POUR LA CREATION D'UNE OFFRE DE VOYAGE\n\n    designationOffreVoyageErrors() {\n      const errors = [];\n      if (!this.$v.offreVoyage.designation.$dirty) return errors;\n      !this.$v.offreVoyage.designation.minLength && errors.push('Au moins quatres (4) caractères pour la designation');\n      !this.$v.offreVoyage.designation.required && errors.push('La désignation est obligatoire.');\n      return errors;\n    },\n    descriptionOffreVoyageErrors() {\n      const errors = [];\n      if (!this.$v.offreVoyage.description.$dirty) return errors;\n      !this.$v.offreVoyage.description.minLength && errors.push('Au moins quatres (4) caractères pour la description');\n      !this.$v.offreVoyage.description.required && errors.push('La description est obligatoire.');\n      return errors;\n    },\n    villeDepartErrors() {\n      const errors = [];\n      if (!this.$v.offreVoyage.villeDepartDesignation.$dirty) return errors;\n      !this.$v.offreVoyage.villeDepartDesignation.required && errors.push('La ville de depart est obligatoire.');\n      return errors;\n    },\n    villeDestinationErrors() {\n      const errors = [];\n      if (!this.$v.offreVoyage.villeDestinationDesignation.$dirty) return errors;\n      !this.$v.offreVoyage.villeDestinationDesignation.required && errors.push('La ville de destination est obligatoire.');\n      return errors;\n    },\n    typeOffreVoyageErrors() {\n      const errors = [];\n      if (!this.$v.offreVoyage.typeOffreVoyageDesignation.$dirty) return errors;\n      !this.$v.offreVoyage.typeOffreVoyageDesignation.required && errors.push('Le type d\\'offre de voyage est obligatoire.');\n      return errors;\n    }\n  },\n  mounted() {\n    this.obtenirTypeOffreVoyageList();\n    this.editerOffreVoyage();\n  }\n};","map":{"version":3,"mappings":";AAiKA;AACA;AACA;AACA;AACA;AACA;AACA;EACAA;EACAC;IACA;MACAC;MACAC,UACA;QAAAC;QAAAC;MAAA,GACA;QAAAD;QAAAC;MAAA,GACA;QAAAD;QAAAC;QAAAC;MAAA,EACA;MACAC;MACAC;MACAC;MAEAC;MACAC;MACAC;MACAC;MAEAC;MAGAC;QACAd;UACAe;QACA;MACA;MAEAC;QACAC;QACAF;QACAG;QACAC;QACAC;QACAC;QACAC;MACA;MAEAC;MACAC;MAEAC;QACAC;MACA;MAEAC;QACAC;MACA;MAEAC;MACAC;MACAC;MACAC;IACA;EACA;EAEAC;IACAjB;MACAD;QACAmB;QACAC;MACA;MACAjB;QACAgB;QACAC;MACA;MACAd;QACAa;MACA;MACAZ;QACAY;MACA;MACAd;QACAc;MACA;IACA;EACA;EAEAE;IAEA;IACAC;MACAC;IACA;IAEA;IACA;MACAA;MACA;IACA;IAEA;IACA;MACAA;MACA;IACA;IAEA;MACAA;MACA;IACA;IAEA;MACAA;MACA;IACA;IAEA;IACA;MACA;MACA;MACA;QACA;UACA;QACA;UACA;QACA;MACA;QACA;QACAA;QACAC;UACAD;QACA;MACA;QACA;MACA;IACA;IAEA;IACA;MACA;MACA;MACA;QACA;UACA;QACA;UACA;QACA;MACA;QACA;QACAA;QACAC;UACAD;QACA;MACA;QACA;MACA;IACA;IAIA;IACA;MACA;MACA;MACA;QACA;UACA;QACA;UACA;QACA;MACA;QACA;QACAA;QACAC;UACAD;QACA;MACA;QACA;MACA;IACA;IAGA;IACA;MACA;MACA;MACA;QACA;UACA;QACA;UACA;QACA;MACA;QACA;QACAA;QACAC;UACAD;QACA;MACA;QACA;MACA;IACA;IAIA;IACA;MACA;MACA;QACA;MACA;QACA;QACAA;QACAC;UACAD;QACA;MACA;IACA;IAEA;MACA;QACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACAE;QACA;UACAA;QACA;MACA;QACA;UAAAC;QAAA;MACA;IACA;IAEA;MACA;MACA;QACA;MACA;QACA;QACAH;QACAC;UACAD;QACA;MACA;IACA;EAEA;EAEAI;IAEA;;IAEAC;MACA;MACA;MACA;MACA;MACA;IACA;IAEAC;MACA;MACA;MACA;MACA;MACA;IACA;IAEAC;MACA;MACA;MACA;MACA;IACA;IAEAC;MACA;MACA;MACA;MACA;IACA;IAEAC;MACA;MACA;MACA;MACA;IACA;EACA;EAGAC;IACA;IACA;EACA;AACA","names":["name","data","search","headers","text","value","sortable","errorMsg","successMsg","overlay","loadingModePrix","loadingVilleEscale","loadingProgrammeOffreVoyage","loadingProprieteOffreVoyage","simpleObject","offreVoyageObject","designation","offreVoyage","id","description","compagnieTransportRaisonSociale","typeOffreVoyageDesignation","villeDepartDesignation","villeDestinationDesignation","referenceTypeOffreVoyageList","villesList","referenceTypeOffreVoyage","referenceFamilleDesignation","objectToSend","datas","prixEtModeParOffreVoyageList","villesEscalesParOffreVoyagesList","jourSemainesParOffreVoyagesList","proprieteParOffreVoyageList","validations","required","minLength","methods","isVisibleOffreVoyageInfo","$","setTimeout","localStorage","path","computed","designationOffreVoyageErrors","descriptionOffreVoyageErrors","villeDepartErrors","villeDestinationErrors","typeOffreVoyageErrors","mounted"],"sourceRoot":"src/components/administration_compagnie_transport","sources":["ModifierOffreVoyage.vue"],"sourcesContent":["<template>\n    <v-app>\n        <v-form>\n            <v-card color=\"teal\">\n                <v-card-title class=\"title_card\">MODIFIER UNE OFFRE DE VOYAGE</v-card-title>\n                <v-card-subtitle>Modiifier portant sur votre de voyage</v-card-subtitle>\n            </v-card><br>\n\n\n\n\n            <v-card>\n                <v-card-title class=\"title_card\">INFORMATION(S) GÉNÉRALE(S) DE L'OFFRE DE VOYAGE\n                    <v-spacer></v-spacer>\n                    <v-btn outlined rounded icon small color=\"teal\" title=\"Voir plus\" @click=\"isVisibleOffreVoyageInfo()\"><v-icon>mdi-plus-outline</v-icon></v-btn>\n                </v-card-title>\n                <v-card max-height=\"675\" id=\"card-info-offre-voyage\">\n                    <v-container fluid>\n                        <v-row><v-col><v-text-field :error-messages=\"designationOffreVoyageErrors\" dense rounded outlined color=\"teal\" label=\"Désignation de l'offre\" v-model.trim=\"$v.offreVoyage.designation.$model\"></v-text-field></v-col></v-row><br>\n                        <v-row><v-col><v-textarea :error-messages=\"descriptionOffreVoyageErrors\" dense outlined rounded color=\"teal\" label=\"Description de l'offre\"></v-textarea></v-col></v-row><br>\n                        <v-row>\n                            <v-col cols=\"6\"><v-select :error-messages=\"villeDepartErrors\" v-model.trim=\"$v.offreVoyage.villeDepartDesignation.$model\" dense rounded outlined :items=\"villesList\" item-text=\"designation\" item-value=\"designation\" color=\"teal\" prefix=\"De :\" label=\"Ville de départ\"></v-select></v-col>\n                            <v-col cols=\"6\"><v-select :error-messages=\"villeDestinationErrors\" v-model.trim=\"$v.offreVoyage.villeDestinationDesignation.$model\" dense rounded outlined :items=\"villesList\" item-text=\"designation\" item-value=\"designation\" color=\"teal\" prefix=\"Vers :\" label=\"ville d'arrivée\"></v-select></v-col>\n                        </v-row><br>\n                        <v-row>\n                            <v-col cols=\"6\"><v-select :items=\"referenceTypeOffreVoyageList\" item-text=\"designation\" item-value=\"designation\" :error-messages=\"typeOffreVoyageErrors\" v-model.trim=\"$v.offreVoyage.typeOffreVoyageDesignation.$model\" dense outlined rounded color=\"teal\" label=\"Type de voyage\"></v-select></v-col>\n                        </v-row>\n                    </v-container>\n                </v-card>\n                <v-card-actions>\n                    <v-btn outlined rounded small>MODIFIER</v-btn>\n                </v-card-actions>\n            </v-card><br>\n\n            <v-card :loading=\"loadingModePrix\">\n                <v-card-title class=\"title_card\">MODE ET PRIX DE L'OFFRE\n                    <v-spacer></v-spacer>\n                    <v-btn outlined rounded icon small color=\"teal\" title=\"Voir plus\" @click=\"isVisiblePrixModeOffreVoyage()\"><v-icon>mdi-plus-outline</v-icon></v-btn>\n                </v-card-title>\n                <v-card id=\"card-prix-mode-offre-voyage\">\n                    <v-container>\n                        <v-row v-if=\"prixEtModeParOffreVoyageList.length\">\n                            <v-col cols=\"6\" v-for=\"(mode,index) in prixEtModeParOffreVoyageList\" :key=\"index\">\n                                <v-card>\n                                    <v-card-title>Mode n° {{ index + 1 }}\n                                        <v-spacer></v-spacer>\n                                        <v-btn icon><v-icon color=\"primary\">mdi-pencil</v-icon></v-btn>\n                                        <v-btn icon><v-icon color=\"red\">mdi-close</v-icon></v-btn>\n                                    </v-card-title>\n                                    <v-container>\n                                        <v-row>\n                                            <v-col cols=\"3\"><small class=\"muted-text\">Désignation :</small></v-col>\n                                            <v-col><span class=\"label-text\">{{ mode.designation }}</span></v-col>\n                                        </v-row>\n                                        <v-row>\n                                            <v-col cols=\"3\"><small class=\"muted-text\">Mode de l'offre :</small></v-col>\n                                            <v-col><span class=\"label-text\">{{ mode.modeDesignation }}</span></v-col>\n                                        </v-row>\n\n                                        <v-row>\n                                            <v-col cols=\"3\"><small class=\"muted-text\">Catégorie :</small></v-col>\n                                            <v-col><span class=\"label-text\">{{ mode.categorieVoyageurDesignation }}</span></v-col>\n                                        </v-row>\n\n                                        <v-row>\n                                            <v-col cols=\"3\"><small class=\"muted-text\">Prix de l'offre :</small></v-col>\n                                            <v-col><span class=\"label-text\">{{ mode.prix }} FCFA</span></v-col>\n                                        </v-row>\n                                    </v-container>\n                                </v-card>\n                            </v-col>\n                        </v-row>\n\n                        <v-row v-else justify=\"center\">\n                            <h4>AUCUN MODE OU PRIX DÉFINI POUR CETTE OFFRE</h4> \n                        </v-row>\n                    </v-container>\n                </v-card>\n            </v-card><br>\n\n            <v-card :loading=\"loadingVilleEscale\">\n                <v-card-title class=\"title_card\">VILLES ESCALES\n                    <v-spacer></v-spacer>\n                    <v-btn outlined rounded icon small color=\"teal\" title=\"Voir plus\" @click=\"isVisibleVilleEscaleOffreVoyage()\"><v-icon>mdi-plus-outline</v-icon></v-btn>\n                </v-card-title>\n                <v-card id=\"card-ville-escale-offre-voyage\">\n                    <v-container>\n                        <v-data-table\n                            :headers=\"headers\"\n                            :items=\"villesEscalesParOffreVoyagesList\"\n                            :search=\"search\">\n\n                            <template v-slot:[`item.actions`]=\"{ item }\">\n                                <v-icon title=\"editer\" color=\"blue\" small class=\"mr-2\" @click=\"editCompagnieTransport(item)\">mdi-pencil</v-icon>                       \n                                <v-icon title=\"supprimer\" color=\"red\" small class=\"mr-2\" @click=\"supprimerProduitLogement(item)\">mdi-delete</v-icon>\n                            </template>\n\n                        </v-data-table>\n                    </v-container>\n                </v-card>\n            </v-card><br>\n\n            <v-card :loading=\"loadingProprieteOffreVoyage\">\n                <v-card-title class=\"title_card\">PROPRIETES DE L'OFFRE\n                    <v-spacer></v-spacer>\n                    <v-btn outlined rounded icon small color=\"teal\" title=\"Voir plus\" @click=\"isVisibleProprieteOffreVoyage()\"><v-icon>mdi-plus-outline</v-icon></v-btn>\n                </v-card-title>\n                <v-card id=\"card-propriete-offre-voyage\"> \n                    <v-container>\n                        <v-row>\n                            <v-col cols=\"6\" v-for=\"(propriete,index) in proprieteParOffreVoyageList\" :key=\"index\">\n                                <v-chip color=\"teal\" text-color=\"white\" class=\"mr-2\"><span class=\"etat\">{{ propriete.designation }}</span></v-chip>\n                            </v-col>\n                        </v-row>\n                    </v-container>\n                </v-card>\n            </v-card><br>\n\n            <v-card :loading=\"loadingProgrammeOffreVoyage\">\n                <v-card-title class=\"title_card\">PROGRAMME DE L'OFFRE\n                    <v-spacer></v-spacer>\n                    <v-btn outlined rounded icon small color=\"teal\" title=\"Voir plus\" @click=\"isVisibleProgrammeOffreVoyage()\"><v-icon>mdi-plus-outline</v-icon></v-btn>\n                </v-card-title>\n                <v-card id=\"card-programme-offre-voyage\">\n                    <v-container>\n                        <v-row>\n                            <v-col cols=\"6\" v-for=\"(jourSemaine,index) in jourSemainesParOffreVoyagesList\" :key=\"index\">\n                                <v-card>\n                                    <v-card-title>Programme n° {{ index + 1 }}\n                                        <v-spacer></v-spacer>\n                                        <v-btn icon><v-icon color=\"primary\">mdi-pencil</v-icon></v-btn>\n                                        <v-btn icon><v-icon color=\"red\">mdi-close</v-icon></v-btn>\n                                    </v-card-title>\n                                    <v-container>\n                                        <v-row>\n                                            <v-col cols=\"3\"><small class=\"muted-text\">Désignation :</small></v-col>\n                                            <v-col><span class=\"label-text\">{{ jourSemaine.designation }}</span></v-col>\n                                        </v-row>\n                                        <v-row>\n                                            <v-col cols=\"3\"><small class=\"muted-text\">Jour :</small></v-col>\n                                            <v-col><span class=\"label-text\">{{ jourSemaine.jourSemaineDesignation }}</span></v-col>\n                                        </v-row>\n\n                                    </v-container>\n                                </v-card>\n                            </v-col>\n                        </v-row>\n                    </v-container>\n                </v-card>\n            </v-card><br>\n\n        </v-form>\n\n        <v-alert class=\"myalert alert-success\" type=\"success\" width=\"350px\" dismissible>{{ successMsg }}</v-alert> \n        <v-alert class=\"myalert alert-error\" type=\"error\" width=\"350px\" dismissible>{{ errorMsg }}</v-alert>\n        <v-overlay :value=\"overlay\"><v-progress-circular indeterminate size=\"64\"></v-progress-circular></v-overlay>\n    </v-app>\n</template>\n\n\n<script>\nimport { required , minLength } from 'vuelidate/lib/validators';\nimport { API_OBTENIR_REFERENCE_PAR_PAR_FAMILLE ,API_OBTENIR_LISTE_DES_VILLES_DISPONIBLE } from '../globalConfig/globalConstConfig'\nimport { API_RECUPERER_PRIX_PAR_OFFRE_VOYAGE , API_RECUPERER_VILLE_ESCALE_PAR_OFFRE_VOYAGE } from '../globalConfig/globalConstConfig'\nimport { API_OBENIR_JOUR_SEMAINE_PAR_OFFRE_VOYAGE , API_RECUPERER_PROPRIETE_PAR_OFFRE_VOYAGE } from '../globalConfig/globalConstConfig'\nimport axios from 'axios'\nimport $ from 'jquery'\nexport default {\n    name: 'ModifierOffreVoyage',\n    data(){\n        return{\n            search:'',\n            headers:[\n                {text : 'Designation' , value : 'designation'},\n                {text : 'Pays' , value : 'paysDesignation'},\n                {text : 'Actions' , value : 'actions' , sortable : false}\n            ],\n            errorMsg : null,\n            successMsg : null,\n            overlay : false,\n\n            loadingModePrix:false,\n            loadingVilleEscale:false,\n            loadingProgrammeOffreVoyage:false,\n            loadingProprieteOffreVoyage:false,\n\n            simpleObject:{},\n\n\n            offreVoyageObject:{\n                data:{\n                    designation:null\n                }\n            },\n\n            offreVoyage:{\n                id:null,\n                designation : null ,\n                description: null,\n                compagnieTransportRaisonSociale : \"COMPAGNIE KOUEVI CT\",\n                typeOffreVoyageDesignation : null,\n                villeDepartDesignation : null,\n                villeDestinationDesignation : null\n            },\n\n            referenceTypeOffreVoyageList:[],\n            villesList : [],\n\n            referenceTypeOffreVoyage:{\n                referenceFamilleDesignation: \"referenceFamilleTypeOffreVoyage\"\n            },\n\n            objectToSend:{\n                datas:[]\n            },\n\n            prixEtModeParOffreVoyageList:[],\n            villesEscalesParOffreVoyagesList:[],\n            jourSemainesParOffreVoyagesList:[],\n            proprieteParOffreVoyageList:[],\n        }\n    },\n\n    validations:{\n        offreVoyage :{\n            designation:{\n                required,\n                minLength : minLength(4)\n            },\n            description:{\n                required,\n                minLength : minLength(4)\n            },\n            villeDepartDesignation:{\n                required,\n            },\n            villeDestinationDesignation:{\n                required,\n            },\n            typeOffreVoyageDesignation:{\n                required\n            }\n        }\n    },\n\n    methods:{\n\n        //RENDRE VISIBLE LES INFORMATIONS SUR L'OFFRE DE VOYAGE SÉLECTIONNÉ\n        isVisibleOffreVoyageInfo(){\n            $(\"#card-info-offre-voyage\").slideToggle(500);           \n        },\n\n        //VISIBILITE DU MODE ET DU PRIX\n        async isVisiblePrixModeOffreVoyage(){\n            $(\"#card-prix-mode-offre-voyage\").slideToggle(500);\n            this.obtenirPrixEtModeParOffreVoyage();\n        },\n\n         //VISIBILITE DES VILLES ESCALES\n        async isVisibleVilleEscaleOffreVoyage(){\n            $(\"#card-ville-escale-offre-voyage\").slideToggle(500);\n            this.obtenirVilleEscaleParOffreVoyage();\n        },\n\n        async isVisibleProgrammeOffreVoyage(){\n            $(\"#card-programme-offre-voyage\").slideToggle(500);\n            this.obtenirJourSemaineParOffreVoyage();\n        },\n\n        async isVisibleProprieteOffreVoyage(){\n            $(\"#card-propriete-offre-voyage\").slideToggle(500);\n            this.obtenirProprietesOffreVoyage();\n        },\n\n        //OBTENIR LE PRIX ET LE MODE PAR OFFRE DE VOYAGE\n        async obtenirPrixEtModeParOffreVoyage(){\n            this.loadingModePrix = true\n            this.offreVoyageObject.data.designation = this.offreVoyage.designation;\n            await axios.post(API_RECUPERER_PRIX_PAR_OFFRE_VOYAGE, this.offreVoyageObject).then((response) => {\n                if (response.data.status.code == 800) {\n                    this.prixEtModeParOffreVoyageList = response.data.items\n                }else{\n                    this.prixEtModeParOffreVoyageList = [];\n                }\n            }).catch((e) => {\n                this.errorMsg = e ;\n                $(\".alert-error\").fadeIn();\n                setTimeout(function(){\n                    $(\".alert-error\").fadeOut(); \n                }, 4000)\n            }).finally(() => {\n                this.loadingModePrix = false;\n            })\n        },\n\n        //OBTENIR LE JOUR DE LA SEMAINE DE L'OFFRE\n        async obtenirJourSemaineParOffreVoyage(){\n            this.loadingProgrammeOffreVoyage = true\n            this.offreVoyageObject.data.designation = this.offreVoyage.designation;\n            await axios.post(API_OBENIR_JOUR_SEMAINE_PAR_OFFRE_VOYAGE , this.offreVoyageObject).then((response) => {\n                if (response.data.status.code == 800) {\n                    this.jourSemainesParOffreVoyagesList = response.data.items\n                }else{\n                    this.jourSemainesParOffreVoyagesList = [];\n                }\n            }).catch((e) => {\n                this.errorMsg = e ;\n                $(\".alert-error\").fadeIn();\n                setTimeout(function(){\n                    $(\".alert-error\").fadeOut(); \n                }, 4000)\n            }).finally(() => {\n                this.loadingProgrammeOffreVoyage = false;\n            })\n        },\n\n\n\n        // OBTENIR LA LISTE DES VILLES ESCALES PAR OFFRE DE VOYAGE\n        async obtenirVilleEscaleParOffreVoyage(){\n            this.loadingVilleEscale = true\n            this.offreVoyageObject.data.designation = this.offreVoyage.designation;\n            await axios.post(API_RECUPERER_VILLE_ESCALE_PAR_OFFRE_VOYAGE, this.offreVoyageObject).then((response) => {\n                if (response.data.status.code == 800) {\n                    this.villesEscalesParOffreVoyagesList = response.data.items\n                }else{\n                    this.villesEscalesParOffreVoyagesList = [];\n                }\n            }).catch((e) => {\n                this.errorMsg = e ;\n                $(\".alert-error\").fadeIn();\n                setTimeout(function(){\n                    $(\".alert-error\").fadeOut(); \n                }, 4000)\n            }).finally(() => {\n                this.loadingVilleEscale = false;\n            })\n        },\n\n\n        // OBTENIR LA LISTE DES PROPRIETES (CARACTERISTIQUES) PAR OFFRE DE VOYAGES\n        async obtenirProprietesOffreVoyage(){\n            this.loadingProprieteOffreVoyage = true\n            this.offreVoyageObject.data.designation = this.offreVoyage.designation;\n            await axios.post(API_RECUPERER_PROPRIETE_PAR_OFFRE_VOYAGE, this.offreVoyageObject).then((response) => {\n                if (response.data.status.code == 800) {\n                    this.proprieteParOffreVoyageList = response.data.items\n                }else{\n                    this.proprieteParOffreVoyageList = [];\n                }\n            }).catch((e) => {\n                this.errorMsg = e ;\n                $(\".alert-error\").fadeIn();\n                setTimeout(function(){\n                    $(\".alert-error\").fadeOut(); \n                }, 4000)\n            }).finally(() => {\n                this.loadingProprieteOffreVoyage = false;\n            })\n        },\n\n\n\n        //OBTENIR REFERENCE DESIGNATION TYPE OFFRE DE VOYAGE\n        async obtenirTypeOffreVoyageList(){\n            this.objectToSend.datas.push(this.referenceTypeOffreVoyage)\n            await axios.post(API_OBTENIR_REFERENCE_PAR_PAR_FAMILLE, this.objectToSend).then((response) => {\n                this.referenceTypeOffreVoyageList = response.data.items\n            }).catch((e) => {\n                this.errorMsg = e ;\n                $(\".alert-error\").fadeIn();\n                setTimeout(function(){\n                    $(\".alert-error\").fadeOut(); \n                }, 4000)\n            })\n        },\n\n        async editerOffreVoyage(){\n            if (localStorage.getItem(\"offreVoyage\")) {\n                try {\n                    const offreVoyageEditing = JSON.parse(localStorage.getItem(\"offreVoyage\"));\n                    this.offreVoyage.id = offreVoyageEditing.id;\n                    this.offreVoyage.designation = offreVoyageEditing.designation;\n                    this.offreVoyage.description = offreVoyageEditing.description;\n                    this.offreVoyage.typeOffreVoyageDesignation = offreVoyageEditing.typeOffreVoyageDesignation;\n                    this.offreVoyage.villeDepartDesignation = offreVoyageEditing.villeDepartDesignation;\n                    this.offreVoyage.villeDestinationDesignation = offreVoyageEditing.villeDestinationDesignation;\n                    localStorage.removeItem(\"offreVoyage\");\n                } catch (error) {\n                    localStorage.removeItem(\"offreVoyage\");\n                }\n            }else{\n                this.$router.replace({path:'/selectionnerOffreVoyage'})\n            }\n        },\n\n        async obtenirListeDesVillesDisponible(){\n            this.loading = false\n            await axios.post(API_OBTENIR_LISTE_DES_VILLES_DISPONIBLE, this.simpleObject).then((response) => {\n                this.villesList = response.data.items\n            }).catch((e) => {\n                this.errorMsg = e ;\n                $(\".alert-error\").fadeIn();\n                setTimeout(function(){\n                    $(\".alert-error\").fadeOut(); \n                }, 4000)\n            })\n        }\n\n    },\n\n    computed:{\n\n        // GESTION DES CONTRAINTES DE CHAMPS D'ENTREES POUR LA CREATION D'UNE OFFRE DE VOYAGE\n\n        designationOffreVoyageErrors(){\n           const errors = [];\n            if (!this.$v.offreVoyage.designation.$dirty) return errors\n            !this.$v.offreVoyage.designation.minLength && errors.push('Au moins quatres (4) caractères pour la designation')\n            !this.$v.offreVoyage.designation.required && errors.push('La désignation est obligatoire.')\n            return errors \n        },\n\n        descriptionOffreVoyageErrors(){\n           const errors = [];\n            if (!this.$v.offreVoyage.description.$dirty) return errors\n            !this.$v.offreVoyage.description.minLength && errors.push('Au moins quatres (4) caractères pour la description')\n            !this.$v.offreVoyage.description.required && errors.push('La description est obligatoire.')\n            return errors \n        },\n\n        villeDepartErrors(){\n           const errors = [];\n            if (!this.$v.offreVoyage.villeDepartDesignation.$dirty) return errors\n            !this.$v.offreVoyage.villeDepartDesignation.required && errors.push('La ville de depart est obligatoire.')\n            return errors \n        },\n\n        villeDestinationErrors(){\n           const errors = [];\n            if (!this.$v.offreVoyage.villeDestinationDesignation.$dirty) return errors\n            !this.$v.offreVoyage.villeDestinationDesignation.required && errors.push('La ville de destination est obligatoire.')\n            return errors \n        },\n\n        typeOffreVoyageErrors(){\n           const errors = [];\n            if (!this.$v.offreVoyage.typeOffreVoyageDesignation.$dirty) return errors\n            !this.$v.offreVoyage.typeOffreVoyageDesignation.required && errors.push('Le type d\\'offre de voyage est obligatoire.')\n            return errors \n        },\n    },\n    \n\n    mounted(){\n        this.obtenirTypeOffreVoyageList();\n        this.editerOffreVoyage();\n    }\n}\n</script>\n\n<style scoped>\n    .etat{\n        font-weight: bold;\n    }\n\n    .title_card{\n        font-weight: bold;\n        font-size: 17px;\n    }\n\n    .myalert{\n        display: none;\n        z-index: 1900;\n    }\n\n    .alert-success{\n        position: fixed;\n        top: 25px;\n        right:2%;\n        width: 25%;\n    }\n\n    .alert-error{\n        position: fixed;\n        top: 25px;\n        right:2%;\n        width: 25%;\n    }\n\n    .muted-text{\n        color: grey;\n    }\n\n    .label-text{\n        color: teal;\n        font-weight: 600;\n        font-size: 16px;\n    }\n\n    #card-info-offre-voyage{\n        display: none;\n    }\n\n    #card-prix-mode-offre-voyage{\n        display: none;\n    }\n\n    #card-ville-escale-offre-voyage{\n        display: none;\n    }\n\n    #card-programme-offre-voyage{\n        display: none;\n    }\n\n    #card-propriete-offre-voyage{\n        display: none;\n    }\n</style>"]},"metadata":{},"sourceType":"module"}